
@{
    Layout = null;
}
@using WNMS.Model.DataModels
<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>添加用户</title>
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    @*<link hrkef="~/lib/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" />*@
    <link href="~/css/bootstrap.min.css" rel="stylesheet" />
    <link href="~/css/font-awesome.min.css" rel="stylesheet" />
    <link href="~/lib/jquery-validation/dist/validation.css" rel="stylesheet" />
    <link href="~/css/zlw.css" rel="stylesheet" />
    <link href="~/css/hyl.css" rel="stylesheet" />
    <style>
    </style>
</head>
<body>
    <div class="box box-danger">
        <div class="box-body">
            <div class="pad20px">
                @model SysUser
                <form class="" autocomplete="off">
                    @Html.AntiForgeryToken()
                    @Html.HiddenFor(model => model.UserId)
                    @Html.HiddenFor(model => model.CreateTime)
                    @Html.HiddenFor(model => model.ErrorTimes)
                    @Html.HiddenFor(model => model.HeadIcon)
                    @Html.HiddenFor(model => model.Imei)
                    @Html.HiddenFor(model => model.IsAdmin)
                    @Html.HiddenFor(model => model.IsEnable)
                    @Html.HiddenFor(model => model.IsLock)
                    @Html.HiddenFor(model => model.LastLoginDate)
                    @Html.HiddenFor(model => model.LitmitTime)
                    @Html.HiddenFor(model => model.WeChatKey)
                    @Html.HiddenFor(model => model.Password)
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="row">
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label for="Account">账号</label>
                                        <div class="input-group">
                                            <div class="input-group-addon">
                                                <i class="fa fa-address-book"></i>
                                            </div>
                                            @Html.TextBoxFor(model => model.Account, new { id = "Account", name = "Account", placeholder = "账号", @class = "form-control" })
                                        </div>
                                    </div>
                                </div>

                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label for="NickName">姓名</label>
                                        <div class="input-group">
                                            <div class="input-group-addon">
                                                <i class="fa fa-user"></i>
                                            </div>
                                            @Html.TextBoxFor(model => model.NickName, new { id = "NickName", name = "NickName", placeholder = "姓名", @class = "form-control" })
                                        </div>
                                    </div>
                                </div>

                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label for="Gender">性别</label>
                                        <div class="input-group">
                                            <div class="input-group-addon">
                                                <i class="fa fa-transgender-alt"></i>
                                            </div>
                                            <select id="Gender" name="Gender" class="form-control">
                                                @{
                                                    if (!Model.Gender)
                                                    {
                                                        <option value="false" selected="selected">男</option>
                                                        <option value="true">女</option>
                                                    }
                                                    else
                                                    {
                                                        <option value="false">男</option>
                                                        <option value="true" selected="selected">女</option>
                                                    }
                                                }
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label for="Department">部门</label>
                                        <div class="input-group">
                                            <div class="input-group-addon">
                                                <i class="fa fa-suitcase"></i>
                                            </div>
                                            <select id="DepartMent" name="DepartMent" class="form-control">
                                                <option value="">==请选择==</option>
                                                @{
                                                    IEnumerable<SysDepartMent> DepartInfoList = ViewBag.Department as IEnumerable<SysDepartMent>;
                                                    foreach (var departinfo in DepartInfoList)
                                                    {
                                                        if (Model.Department == departinfo.DepartmentId)
                                                        {
                                                            <option value="@departinfo.DepartmentId" selected="selected">@departinfo.DptName</option>
                                                        }
                                                        else
                                                        {
                                                            <option value="@departinfo.DepartmentId">@departinfo.DptName</option>
                                                        }
                                                    }
                                                }
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label for="Phone">电话</label>
                                        <div class="input-group">
                                            <div class="input-group-addon">
                                                <i class="fa fa-phone"></i>
                                            </div>
                                            @Html.TextBoxFor(model => model.Phone, new { id = "Phone", name = "Phone", placeholder = "PhoneNumber", @class = "form-control" })
                                        </div>
                                    </div>
                                </div>

                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label for="Email">邮箱</label>
                                        <div class="input-group">
                                            <div class="input-group-addon">
                                                <i class="fa fa-envelope-square"></i>
                                            </div>
                                            @Html.TextBoxFor(model => model.Email, new { id = "Email", name = "Email", placeholder = "Email", @class = "form-control" })
                                        </div>
                                    </div>
                                </div>

                                @*<div class="col-sm-6">
                                        <div class="form-group">
                                            <label for="WeChatKey">微信</label>
                                            <div class="input-group">
                                                <div class="input-group-addon">
                                                    <i class="fa fa-weixin"></i>
                                                </div>
                                                @Html.TextBoxFor(model => model.WeChatKey, new { id = "WeChatKey", name = "WeChatKey", placeholder = "微信号", @class = "form-control" })
                                            </div>
                                        </div>
                                    </div>*@
                                @*<div class="col-sm-6">
                                    <div class="form-group">
                                        <label for="WeChatKey">微信号</label>
                                        <div class="input-group">
                                            <div class="input-group-addon">
                                                <i class="fa fa-weixin"></i>
                                            </div>
                                            @Html.TextBoxFor(model => model.WeChatKey, new { id = "WeChatKey", name = "WeChatKey", placeholder = "微信", @class = "form-control" })
                                        </div>
                                    </div>
                                </div>*@
                                @*<div class="col-sm-6">
                                    <div class="form-group">
                                        <label for="SerialNumber">GPS设备编号</label>
                                        <div class="input-group">
                                            <div class="input-group-addon">
                                                <i class="fa fa-globe"></i>
                                            </div>
                                            @Html.TextBoxFor(model => model.SerialNumber, new { id = "SerialNumber", name = "SerialNumber", placeholder = "GPS设备编号", @class = "form-control" })
                                        </div>
                                    </div>
                                </div>*@
                            </div>
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group">
                                        <label for="Remark">备注</label>
                                        <div>
                                            @Html.TextAreaFor(model => model.Remark, new { id = "Remark", name = "Remark", placeholder = "描述", @class = "form-control" })
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>

            </div>
        </div>
    </div>
    <script src="~/js/jquery.min.js"></script>
    <script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
    <script type="text/javascript">
        $(function () {
            validateForm();
        });

        // 联系电话(手机/电话皆可)验证
        jQuery.validator.addMethod("isPhone", function (value, element) {
            var length = value.length;
            var mobile = /^(((13[0-9]{1})|(15[0-9]{1}))+\d{8})$/;
            var tel = /^\d{3,4}-?\d{7,9}$/;
            return this.optional(element) || (tel.test(value) || mobile.test(value));

        }, "请正确填写您的联系电话");

        function validateForm() {
            $("form").validate({
                debug: true,
                ignore: "",
                rules: {
                    Account: "required",
                    DepartMent: {
                        required: true,
                        digits: true,
                        min: 1
                    },
                    Phone: {
                        isPhone: true
                    },
                    Email: {
                        email: true
                    }
                },
                messages: {
                    Account: "请输入账号",
                    DepartMent: {
                        required: "请选择部门",
                        digits: "请选择部门",
                        min: "请选择部门"
                    },
                    Phone: {
                        isPhone: "请输入正确的联系电话"
                    },
                    Email: {
                        email: "请输入一个正确的邮箱"
                    }
                }
            });
        }

        function saveForm(func) {
            if ($("form").valid()) {
                $.ajax({
                    url: '/Sys/User/SetUserInfo',
                    type: 'post',

                    data: $("form").serializeArray(),
                    success: function (data) {
                        func(data);
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {
                        alert(errorThrown);
                    }
                });
            }
        }
    </script>
</body>
</html>
