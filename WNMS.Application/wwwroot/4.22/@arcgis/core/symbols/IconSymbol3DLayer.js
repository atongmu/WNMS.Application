/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
import{_ as o}from"../chunks/tslib.es6.js";import{L as r}from"../chunks/Logger.js";import{i as t}from"../core/lang.js";import{isDataProtocol as e,isAbsolute as s,normalize as i,makeData as n}from"../core/urlUtils.js";import{property as c}from"../core/accessorSupport/decorators/property.js";import"../chunks/ensureType.js";import{e as l}from"../chunks/enumeration.js";import{subclass as a}from"../core/accessorSupport/decorators/subclass.js";import p from"./Symbol3DLayer.js";import{w as h,i as m}from"../chunks/colors.js";import{s as u}from"../chunks/jsonMap.js";import{a as y}from"../chunks/JSONSupport.js";import{r as d}from"../chunks/reader.js";import{w as f}from"../chunks/writer.js";import{f as j,t as b}from"../chunks/persistableUrlUtils.js";import{c as k,s as v}from"../chunks/materialUtils.js";import g from"../core/Accessor.js";import w from"../Color.js";import{p as S}from"../chunks/screenUtils.js";import{S as x}from"../chunks/Symbol3DMaterial.js";import"../config.js";import"../chunks/object.js";import"../chunks/string.js";import"../core/Error.js";import"../chunks/metadata.js";import"../chunks/handleUtils.js";import"../chunks/opacityUtils.js";import"../chunks/deprecate.js";import"../chunks/ArrayPool.js";import"../core/scheduling.js";import"../chunks/nextTick.js";import"../core/promiseUtils.js";import"../chunks/colorUtils.js";import"../chunks/mathUtils.js";import"../chunks/common.js";var z;const U=u()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let P=z=class extends y{constructor(o){super(o)}readHref(o,r,t){return o?j(o,t):r.dataURI}writeHref(o,r,t,n){o&&(e(o)?r.dataURI=o:(r.href=b(o,n),s(r.href)&&(r.href=i(r.href))))}clone(){return new z({href:this.href,primitive:this.primitive})}};o([c({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],P.prototype,"href",void 0),o([d("href")],P.prototype,"readHref",null),o([f("href",{href:{type:String},dataURI:{type:String}})],P.prototype,"writeHref",null),o([l(U)],P.prototype,"primitive",void 0),P=z=o([a("esri.symbols.support.IconSymbol3DLayerResource")],P);const I="circle",L=P;var D;let R=D=class extends g{constructor(){super(...arguments),this.x=0,this.y=0}clone(){return new D({x:this.x,y:this.y})}};o([c({type:Number})],R.prototype,"x",void 0),o([c({type:Number})],R.prototype,"y",void 0),R=D=o([a("esri.symbols.support.Symbol3DAnchorPosition2D")],R);const M=R;var N;let q=N=class extends y{constructor(o){super(o),this.color=new w([0,0,0,1]),this.size=S(1)}clone(){const o={color:t(this.color)?this.color.clone():null,size:this.size};return new N(o)}};o([c(k)],q.prototype,"color",void 0),o([c(v)],q.prototype,"size",void 0),q=N=o([a("esri.symbols.support.Symbol3DIconOutline")],q);const H=q;var O;const A=r.getLogger("esri.symbols.IconSymbol3DLayer");let T=O=class extends p{constructor(o){super(o),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=void 0,this.outline=void 0}clone(){return new O({anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),enabled:this.enabled,material:t(this.material)?this.material.clone():null,outline:t(this.outline)?this.outline.clone():null,resource:this.resource&&this.resource.clone(),size:this.size})}static fromSimpleMarkerSymbol(o){const r=o.color||h,t=C(o),e=o.outline&&o.outline.width>0?{size:o.outline.width,color:(o.outline.color||h).clone()}:null;return new O({size:o.size,resource:{primitive:E(o.style)},material:{color:r},outline:e,anchor:t?"relative":void 0,anchorPosition:t})}static fromPictureMarkerSymbol(o){const r=!o.color||m(o.color)?h:o.color,t=C(o);return new O({size:o.width<=o.height?o.height:o.width,resource:{href:o.url},material:{color:r.clone()},anchor:t?"relative":void 0,anchorPosition:t})}static fromCIMSymbol(o){return new O({resource:{href:n({mediaType:"application/json",data:JSON.stringify(o.data)})}})}};function C(o){const r="width"in o?o.width:o.size,t="height"in o?o.height:o.size,e=F(o.xoffset),s=F(o.yoffset);return(e||s)&&r&&t?{x:-e/r,y:s/t}:null}function F(o){return isFinite(o)?o:0}o([c({type:x,json:{write:!0}})],T.prototype,"material",void 0),o([c({type:L,json:{write:!0}})],T.prototype,"resource",void 0),o([l({Icon:"icon"},{readOnly:!0})],T.prototype,"type",void 0),o([c(v)],T.prototype,"size",void 0),o([l({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"}),c({json:{default:"center"}})],T.prototype,"anchor",void 0),o([c({type:R,json:{type:[Number],read:{reader:o=>new R({x:o[0],y:o[1]})},write:{writer:(o,r)=>{r.anchorPosition=[o.x,o.y]},overridePolicy(){return{enabled:"relative"===this.anchor}}}}})],T.prototype,"anchorPosition",void 0),o([c({type:H,json:{write:!0}})],T.prototype,"outline",void 0),T=O=o([a("esri.symbols.IconSymbol3DLayer")],T);const J={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function E(o){const r=J[o];return r||(A.warn(`${o} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}const $=T;export{M as S,I as d,$ as default};
