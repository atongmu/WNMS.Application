/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
import{h as t,H as e,c as i,F as a,p as s}from"../widgets/Widget.js";import{C as n,S as r,I as l}from"./resources3.js";import{f as o,a as c,g as m,C as d}from"./dom.js";import{g as p}from"./array.js";import{d as u}from"./debounce.js";import{c as h}from"./observers.js";import{d as f}from"./calcite-icon2.js";import{d as b,a as g}from"./calcite-input2.js";import{d as y}from"./calcite-loader2.js";import{d as w}from"./calcite-scrim2.js";import{f as k}from"./forIn.js";import"./tslib.es6.js";import"../intl.js";import"./number.js";import"./jsonMap.js";import"./object.js";import"../core/lang.js";import"./locale.js";import"./Logger.js";import"../config.js";import"./string.js";import"./messages.js";import"../core/Error.js";import"../core/promiseUtils.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"./assets.js";import"./deprecate.js";import"./domUtils.js";import"./Evented.js";import"../core/Accessor.js";import"../core/accessorSupport/decorators/property.js";import"./ensureType.js";import"./metadata.js";import"./handleUtils.js";import"./ArrayPool.js";import"../core/accessorSupport/decorators/subclass.js";import"../core/scheduling.js";import"./nextTick.js";import"../core/Handles.js";import"../core/Collection.js";import"./shared.js";import"./Promise.js";import"./uuid.js";import"../core/watchUtils.js";import"../core/accessorSupport/decorators/cast.js";import"./projector.js";import"./widgetUtils.js";import"./jsxWidgetSupport.js";import"./key.js";import"./label.js";import"./form.js";
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 */function x(){this.setUpItems(),this.setUpFilter()}const v=["ArrowUp","ArrowDown"];function j(){this.setUpItems(),this.setUpFilter(),this.emitCalciteListChange=u(H.bind(this),0)}function D(){var t;null===(t=this.mutationObserver)||void 0===t||t.observe(this.el,{childList:!0,subtree:!0})}function E(){var t;null===(t=this.mutationObserver)||void 0===t||t.disconnect()}function I(t){const{selectedValues:e}=this,{item:i,value:a,selected:s,shiftPressed:n}=t.detail;s?(this.multiple&&n&&this.selectSiblings(i),this.multiple||this.deselectSiblingItems(i),e.set(a,i)):(e.delete(a),this.multiple&&n&&this.selectSiblings(i,!0)),this.multiple||(_(i,s),s&&o(i)),this.lastSelectedItem=i,this.emitCalciteListChange()}function F(t){t.stopPropagation();const e=t.detail.oldValue,i=this.selectedValues;if(i.has(e)){const a=i.get(e);i.delete(e),i.set(t.detail.newValue,a)}}function C(t){const{el:e,items:i,multiple:a,selectedValues:s}=this;if(a)return;!e.contains(t.relatedTarget)?i.forEach((e=>_(e,0===s.size?t.target===e:e.selected))):_(t.target,!1)}function L(t){const{key:e,target:i}=t;if(!function(t){return!!v.find((e=>e===t))}(e))return;const{items:a,multiple:s,selectionFollowsFocus:n}=this,{length:r}=a,l=a.indexOf(i);if(!r||-1===l)return;t.preventDefault();const c=a[p(l+("ArrowUp"===e?-1:1),r)];a.forEach((t=>_(t,t===c))),!s&&n&&(c.selected=!0),o(c)}function H(){this.calciteListChange.emit(this.selectedValues)}function S(t){if(t.defaultPrevented)return;const e=t.target,i=this.selectedValues;"CALCITE-PICK-LIST-GROUP"===e.parentElement.tagName?(e.parentElement.remove(),Array.from(e.parentElement.children).forEach((t=>i.delete(t.value)))):(e.remove(),i.delete(e.value)),this.emitCalciteListChange()}function _(t,e){e?t.removeAttribute("tabindex"):t.setAttribute("tabindex","-1")}async function V(t){if(this.filterEnabled&&"filter"===t)return void await o(this.filterEl);const{items:e,multiple:i,selectionFollowsFocus:a}=this;if(0===e.length)return;if(i)return e[0].setFocus();const s=e.find((t=>t.selected))||e[0];return a&&(s.selected=!0),s.setFocus()}function O(t){this.items=Array.from(this.el.querySelectorAll(t));let e=!1;const{items:i}=this;i.forEach((t=>{t.icon=this.getIconType(),this.multiple||(t.disableDeselect=!0,_(t,!1)),t.selected&&(e=!0,_(t,!0),this.selectedValues.set(t.value,t))}));const[a]=i;!e&&a&&_(a,!0)}function z(t){this.items.forEach((e=>{e.value!==t.value&&(e.toggleSelected(!1),this.selectedValues.has(e.value)&&this.selectedValues.delete(e.value))}))}function P(t,e=!1){if(!this.lastSelectedItem)return;const{items:i}=this,a=i.findIndex((t=>t.value===this.lastSelectedItem.value)),s=i.findIndex((e=>e.value===t.value));i.slice(Math.min(a,s),Math.max(a,s)).forEach((t=>{t.toggleSelected(!e),e?this.selectedValues.delete(t.value):this.selectedValues.set(t.value,t)}))}let U;function A(t){const e=t.detail.map((t=>t.value));let i=!1;U||(U=new Set);const a=this.items.filter((t=>{const a=t.parentElement;a.matches("calcite-pick-list-group")&&U.add(a);const s=e.includes(t.value);return t.hidden=!s,i||(i=s&&t.selected),s}));U.forEach((t=>{const e=a.some((e=>t.contains(e)));if(t.hidden=!e,!e)return;const i=c(t,"parent-item");i&&(i.hidden=!1,a.includes(i)&&Array.from(t.children).forEach((t=>t.hidden=!1)))})),U.clear(),a.length>0&&!i&&!this.multiple&&_(a[0],!0)}function T(){return this.items.map((t=>({label:t.label,description:t.description,metadata:t.metadata,value:t.value})))}const M=i=>{var{props:{disabled:a,loading:s,filterEnabled:l,dataForFilter:o,handleFilter:c,filterPlaceholder:d,el:p,setFilterEl:u}}=i,h=function(t,e){var i={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(i[a]=t[a]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(t);s<a.length;s++)e.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(t,a[s])&&(i[a[s]]=t[a[s]])}return i}(i,["props"]);const f=t("slot",null);return t(e,Object.assign({"aria-busy":s.toString(),"aria-disabled":a.toString(),role:"menu"},h),t("section",null,t("header",{class:{[n.sticky]:!0}},l?t("calcite-filter",{"aria-label":d,data:o,dir:m(p),disabled:s||a,onCalciteFilterChange:c,placeholder:d,ref:u}):null,t("slot",{name:r.menuActions})),s||a?t("calcite-scrim",{loading:s}):null,f))},R="container",q="clear-button",K="Filter",W="Clear filter",G="search",N="x";
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 */let B=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.calciteFilterChange=i(this,"calciteFilterChange",7),this.disabled=!1,this.filteredItems=[],this.filter=u((t=>{const e=new RegExp(t,"i");if(0===this.items.length)return void this.updateFiltered([]);const i=(t,e)=>{let a=!1;return k(t,(t=>{"function"!=typeof t&&(Array.isArray(t)||"object"==typeof t&&null!==t?i(t,e)&&(a=!0):e.test(t)&&(a=!0))})),a},a=this.items.filter((t=>i(t,e)));this.updateFiltered(a)}),250),this.inputHandler=t=>{const e=t.target;this.value=e.value},this.keyDownHandler=({key:t})=>{"Escape"===t&&this.clear()},this.clear=()=>{this.value="",this.setFocus()}}watchDataHandler(t){this.items=t}watchItemsHandler(){this.filter(this.value)}valueHandler(t){this.filter(t)}connectedCallback(){this.data&&!this.items&&(this.items=this.data)}async setFocus(){o(this.textInput)}updateFiltered(t){this.filteredItems.length=0,this.filteredItems=this.filteredItems.concat(t),this.calciteFilterChange.emit(t)}render(){const e="rtl"===m(this.el),{disabled:i}=this;return t(a,null,i?t("calcite-scrim",null):null,t("div",{class:R},t("label",{class:e?d.rtl:null},t("calcite-input",{"aria-label":this.intlLabel||K,class:e?d.rtl:null,disabled:this.disabled,icon:G,onCalciteInputInput:this.inputHandler,onKeyDown:this.keyDownHandler,placeholder:this.placeholder,ref:t=>{this.textInput=t},type:"text",value:this.value})),this.value?t("button",{"aria-label":this.intlClear||W,class:q,onClick:this.clear},t("calcite-icon",{icon:N})):null))}get el(){return this}static get watchers(){return{data:["watchDataHandler"],items:["watchItemsHandler"],value:["valueHandler"]}}static get style(){return"@-webkit-keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in{0%{opacity:0}100%{opacity:1}}@-webkit-keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}@keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:300ms}.calcite-animate{opacity:0;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-duration:var(--calcite-animation-timing);animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{-webkit-animation-name:in;animation-name:in}.calcite-animate__in-down{-webkit-animation-name:in-down;animation-name:in-down}.calcite-animate__in-up{-webkit-animation-name:in-up;animation-name:in-up}.calcite-animate__in-scale{-webkit-animation-name:in-scale;animation-name:in-scale}:host{-webkit-box-sizing:border-box;box-sizing:border-box;background-color:var(--calcite-ui-foreground-1);color:var(--calcite-ui-text-2);font-size:var(--calcite-font-size--1)}:host *{-webkit-box-sizing:border-box;box-sizing:border-box}:root{--calcite-popper-transition:150ms ease-in-out}:host([hidden]){display:none}:host{display:-ms-flexbox;display:flex;width:100%}.container{display:-ms-flexbox;display:flex;width:100%;padding:0.5rem}label{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;overflow:hidden;position:relative;width:100%;margin-left:0.25rem;margin-right:0.25rem;margin-top:0;margin-bottom:0}input[type=text]{background-color:transparent;border-style:none;font-family:inherit;color:var(--calcite-ui-text-1);font-size:var(--calcite-font-size--2);line-height:1rem;margin-bottom:0.25rem;width:100%;padding-top:0.25rem;padding-bottom:0.25rem;padding-right:0.25rem;padding-left:1.5rem;-webkit-transition:padding 150ms ease-in-out, -webkit-box-shadow 150ms ease-in-out;transition:padding 150ms ease-in-out, -webkit-box-shadow 150ms ease-in-out;transition:padding 150ms ease-in-out, box-shadow 150ms ease-in-out;transition:padding 150ms ease-in-out, box-shadow 150ms ease-in-out, -webkit-box-shadow 150ms ease-in-out}input[type=text]::-ms-clear{display:none}calcite-input{width:100%}.search-icon{display:-ms-flexbox;display:flex;left:0;position:absolute;color:var(--calcite-ui-text-2);-webkit-transition:left 150ms ease-in-out, right 150ms ease-in-out, opacity 150ms ease-in-out;transition:left 150ms ease-in-out, right 150ms ease-in-out, opacity 150ms ease-in-out}.calcite--rtl .search-icon{right:0}input[type=text]:focus{border-color:var(--calcite-ui-brand);outline:2px solid transparent;outline-offset:2px;padding-left:0.25rem;padding-right:0.25rem}input[type=text]:focus~.search-icon{left:calc(1rem * -1);opacity:0}.calcite--rtl input[type=text]{padding-left:0.25rem;padding-right:1.5rem}.calcite--rtl input[type=text]:focus{padding-right:1.25rem}.calcite--rtl input[type=text]:focus~.search-icon{right:calc(1rem * -1)}.clear-button{color:var(--calcite-ui-text-2);background-color:transparent;border-width:0;cursor:pointer;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.clear-button:hover,.clear-button:focus{color:var(--calcite-ui-text-1)}"}};function J(){["calcite-filter","calcite-icon","calcite-input","calcite-loader","calcite-progress","calcite-scrim"].forEach((t=>{switch(t){case"calcite-filter":customElements.get(t)||customElements.define(t,B);break;case"calcite-icon":customElements.get(t)||f();break;case"calcite-input":customElements.get(t)||g();break;case"calcite-loader":customElements.get(t)||y();break;case"calcite-progress":customElements.get(t)||b();break;case"calcite-scrim":customElements.get(t)||w()}}))}B=s(B,[1,"calcite-filter",{data:[16],items:[1040],disabled:[516],filteredItems:[1040],intlClear:[1,"intl-clear"],intlLabel:[1,"intl-label"],placeholder:[1],value:[1025],setFocus:[64]}]),J();let Q=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.calciteListChange=i(this,"calciteListChange",7),this.disabled=!1,this.filterEnabled=!1,this.loading=!1,this.multiple=!1,this.selectionFollowsFocus=!1,this.selectedValues=new Map,this.dataForFilter=[],this.lastSelectedItem=null,this.mutationObserver=h("mutation",x.bind(this)),this.setFilterEl=t=>{this.filterEl=t},this.deselectSiblingItems=z.bind(this),this.selectSiblings=P.bind(this),this.handleFilter=A.bind(this),this.getItemData=T.bind(this),this.keyDownHandler=L.bind(this)}connectedCallback(){j.call(this),D.call(this)}disconnectedCallback(){E.call(this)}calciteListItemRemoveHandler(t){S.call(this,t)}calciteListItemChangeHandler(t){I.call(this,t)}calciteListItemPropsChangeHandler(t){t.stopPropagation(),this.setUpFilter()}calciteListItemValueChangeHandler(t){F.call(this,t)}calciteListFocusOutHandler(t){C.call(this,t)}setUpItems(){O.call(this,"calcite-pick-list-item")}setUpFilter(){this.filterEnabled&&(this.dataForFilter=this.getItemData())}async getSelectedItems(){return this.selectedValues}async setFocus(t){return V.call(this,t)}getIconType(){return this.multiple?l.square:l.circle}render(){return t(M,{onKeyDown:this.keyDownHandler,props:this})}get el(){return this}static get style(){return"@-webkit-keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in{0%{opacity:0}100%{opacity:1}}@-webkit-keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}@keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:300ms}.calcite-animate{opacity:0;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-duration:var(--calcite-animation-timing);animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{-webkit-animation-name:in;animation-name:in}.calcite-animate__in-down{-webkit-animation-name:in-down;animation-name:in-down}.calcite-animate__in-up{-webkit-animation-name:in-up;animation-name:in-up}.calcite-animate__in-scale{-webkit-animation-name:in-scale;animation-name:in-scale}:root{--calcite-popper-transition:150ms ease-in-out}:host([hidden]){display:none}:host{-ms-flex-align:stretch;align-items:stretch;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;position:relative;-ms-flex-positive:1;flex-grow:1;-ms-flex-negative:0;flex-shrink:0;color:var(--calcite-ui-text-2);font-size:var(--calcite-font-size--1);line-height:1rem}:host *{-webkit-box-sizing:border-box;box-sizing:border-box}:host([filter-enabled]) header{background-color:var(--calcite-ui-foreground-1);display:-ms-flexbox;display:flex;-ms-flex-pack:end;justify-content:flex-end;-ms-flex-align:stretch;align-items:stretch;margin-bottom:0.25rem;-webkit-box-shadow:0 1px 0 var(--calcite-ui-border-3);box-shadow:0 1px 0 var(--calcite-ui-border-3)}:host([filter-enabled]) header.sticky{position:-webkit-sticky;position:sticky;top:0;z-index:1}calcite-filter{margin-bottom:0}:host([loading][disabled]){min-height:2rem}"}};function X(){["calcite-pick-list","calcite-filter","calcite-icon","calcite-input","calcite-loader","calcite-progress","calcite-scrim"].forEach((t=>{switch(t){case"calcite-pick-list":customElements.get(t)||customElements.define(t,Q);break;case"calcite-filter":customElements.get(t)||J();break;case"calcite-icon":customElements.get(t)||f();break;case"calcite-input":customElements.get(t)||g();break;case"calcite-loader":customElements.get(t)||y();break;case"calcite-progress":customElements.get(t)||b();break;case"calcite-scrim":customElements.get(t)||w()}}))}Q=s(Q,[1,"calcite-pick-list",{disabled:[516],filterEnabled:[516,"filter-enabled"],filterPlaceholder:[513,"filter-placeholder"],headingLevel:[2,"heading-level"],loading:[516],multiple:[516],selectionFollowsFocus:[4,"selection-follows-focus"],selectedValues:[32],dataForFilter:[32],getSelectedItems:[64],setFocus:[64]},[[0,"calciteListItemRemove","calciteListItemRemoveHandler"],[0,"calciteListItemChange","calciteListItemChangeHandler"],[0,"calciteListItemPropsChange","calciteListItemPropsChangeHandler"],[0,"calciteListItemValueChange","calciteListItemValueChangeHandler"],[0,"focusout","calciteListFocusOutHandler"]]]),X();const Y=Q,Z=X;export{Y as CalcitePickList,Z as defineCustomElement};
