/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
import{c as e,h as t,p as i}from"../widgets/Widget.js";import{c as o,d as l}from"./calcite-color-picker-swatch2.js";import{g as n,f as a,C as r}from"./dom.js";import{g as s}from"./key.js";import{d as c}from"./calcite-icon2.js";import{d as h,a as d}from"./calcite-input2.js";import{c as u}from"./math.js";import{d as m}from"./calcite-button2.js";import{d as p}from"./calcite-loader2.js";import{d as f}from"./calcite-tab2.js";import{d as g}from"./calcite-tab-nav2.js";import{d as C}from"./calcite-tab-title2.js";import{d as v}from"./calcite-tabs2.js";import{d as b,i as w}from"./debounce.js";import"./tslib.es6.js";import"../intl.js";import"./number.js";import"./jsonMap.js";import"./object.js";import"../core/lang.js";import"./locale.js";import"./Logger.js";import"../config.js";import"./string.js";import"./messages.js";import"../core/Error.js";import"../core/promiseUtils.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"./assets.js";import"./deprecate.js";import"./domUtils.js";import"./Evented.js";import"../core/Accessor.js";import"../core/accessorSupport/decorators/property.js";import"./ensureType.js";import"./metadata.js";import"./handleUtils.js";import"./ArrayPool.js";import"../core/accessorSupport/decorators/subclass.js";import"../core/scheduling.js";import"./nextTick.js";import"../core/Handles.js";import"../core/Collection.js";import"./shared.js";import"./Promise.js";import"./uuid.js";import"../core/watchUtils.js";import"../core/accessorSupport/decorators/cast.js";import"./projector.js";import"./widgetUtils.js";import"./jsxWidgetSupport.js";import"./observers.js";import"./label.js";import"./form.js";
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 */function S(e){const{r:t,g:i,b:o}=e;return`#${t.toString(16).padStart(2,"0")}${i.toString(16).padStart(2,"0")}${o.toString(16).padStart(2,"0")}`.toLowerCase()}const x=/^[0-9A-F]$/i,y=/^#[0-9A-F]{3}$/i,k=/^#[0-9A-F]{6}$/i;function F(e){return A(e)||D(e)}function A(e){return e&&4===e.length&&y.test(e)}function D(e){return e&&7===e.length&&k.test(e)}function j(e){return(e=e.toLowerCase()).startsWith("#")||(e=`#${e}`),A(e)?S(H(e)):e}function H(e){if(!F(e))return null;if(3===(e=e.replace("#","")).length){const[t,i,o]=e.split("");return{r:parseInt(`${t}${t}`,16),g:parseInt(`${i}${i}`,16),b:parseInt(`${o}${o}`,16)}}return{r:parseInt(e.slice(0,2),16),g:parseInt(e.slice(2,4),16),b:parseInt(e.slice(4,6),16)}}const T={HEX:"hex",HEXA:"hexa",RGB_CSS:"rgb-css",RGBA_CSS:"rgba-css",HSL_CSS:"hsl-css",HSLA_CSS:"hsla-css"},E={RGB:"rgb",RGBA:"rgba",HSL:"hsl",HSLA:"hsla",HSV:"hsv",HSVA:"hsva"};function I(e){if("string"==typeof e){if(e.startsWith("#")){const{length:t}=e;if(4===t||7===t)return T.HEX;if(5===t||9===t)return T.HEXA}if(e.startsWith("rgba("))return T.RGBA_CSS;if(e.startsWith("rgb("))return T.RGB_CSS;if(e.startsWith("hsl("))return T.HSL_CSS;if(e.startsWith("hsla("))return T.HSLA_CSS}if("object"==typeof e){if(M(e,"r","g","b"))return M(e,"a")?E.RGBA:E.RGB;if(M(e,"h","s","l"))return M(e,"a")?E.HSLA:E.HSL;if(M(e,"h","s","v"))return M(e,"a")?E.HSVA:E.HSV}return null}function M(e,...t){return t.every((t=>t&&e&&`${t}`in e))}function R(e,t){return(null==e?void 0:e.rgbNumber())===(null==t?void 0:t.rgbNumber())}
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 */const L="container",_="control-section",$="color-hex-options",P="section",B="header",N="control",U="section--split",V="color-mode-container",K="color-mode",G="channels",O="channel",W="saved-colors",z="saved-colors-section",X="save-color",q="delete-color",J="saved-colors-buttons",Y="header--hex",Q="color-field-and-slider",Z="color-field-and-slider--interactive",ee="color-field-and-slider-wrap",te="scope",ie="scope--hue",oe="scope--color-field",le="saved-color",ne=o("#007AC2"),ae={r:255,g:255,b:255},re={h:360,s:100,v:100},se="B",ce="Blue",he="Delete color",de="G",ue="Green",me="H",pe="HSV",fe="Hex",ge="Hue",Ce="No color",ve="R",be="Red",we="RGB",Se="S",xe="Saturation",ye="Save color",ke="Saved",Fe="V",Ae="Value",De={s:{slider:{height:10,width:160},colorField:{height:80,width:160},thumb:{radius:8}},m:{slider:{height:14,width:272},colorField:{height:150,width:272},thumb:{radius:10}},l:{slider:{height:16,width:464},colorField:{height:200,width:464},thumb:{radius:12}}},je="container",He="preview",Te="input",Ee=o();let Ie=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.calciteColorPickerHexInputChange=e(this,"calciteColorPickerHexInputChange",7),this.allowEmpty=!1,this.intlHex=fe,this.intlNoColor=Ce,this.scale="m",this.value=j(Ee.hex()),this.onCalciteInputBlur=e=>{const t=e.currentTarget,i=t.value,o=`#${i}`;this.allowEmpty&&!i||F(o)&&D(o)||(t.value=this.allowEmpty&&!this.internalColor?"":this.formatForInternalInput(S(this.internalColor.object())))},this.onInputChange=e=>{const t=e.currentTarget.value;let i;if(t){const e=t;if(!H(`#${e}`))return;i=j(e)}else this.allowEmpty&&(i=null);this.value=i,this.calciteColorPickerHexInputChange.emit()},this.internalColor=Ee,this.previousNonNullValue=this.value,this.storeInputRef=e=>{this.inputNode=e}}connectedCallback(){const{allowEmpty:e,value:t}=this;if(t){const e=j(t);F(e)&&(this.internalColor=o(e),this.value=e)}else e&&(this.internalColor=null,this.value=null)}handleValueChange(e,t){if(e){const t=j(e);if(F(t)){const{internalColor:e}=this,i=!e||t!==j(e.hex());return this.internalColor=o(t),this.previousNonNullValue=t,this.value=t,void(i&&this.calciteColorPickerHexInputChange.emit())}}else if(this.allowEmpty)return this.internalColor=null,this.value=null,void this.calciteColorPickerHexInputChange.emit();this.value=t}onInputKeyDown(e){const{altKey:t,ctrlKey:i,metaKey:o,shiftKey:l}=e,{el:n,inputNode:a,internalColor:r,value:c}=this,h=s(e.key);if("ArrowDown"===h||"ArrowUp"===h){if(!c)return this.value=this.previousNonNullValue,void e.preventDefault();const t="ArrowUp"===h?1:-1,i=l?10:1;return this.value=j(this.nudgeRGBChannels(r,i*t).hex()),void e.preventDefault()}const d=t||i||o,u=a.value.length>=6,m=n.shadowRoot.activeElement,p=m.selectionStart!=m.selectionEnd,f=1===h.length,g=x.test(h);!f||d||g&&(p||!u)||e.preventDefault()}render(){const{el:e,intlHex:i,value:o}=this,l=this.formatForInternalInput(o),a=n(e);return t("div",{class:je},t("calcite-input",{class:Te,dir:a,label:i,onCalciteInputBlur:this.onCalciteInputBlur,onChange:this.onInputChange,prefixText:"#",ref:this.storeInputRef,scale:this.scale,value:l}),l?t("calcite-color-picker-swatch",{active:!0,class:He,color:`#${l}`,scale:this.scale}):null)}async setFocus(){a(this.inputNode)}formatForInternalInput(e){return e?e.replace("#",""):""}nudgeRGBChannels(e,t){return o.rgb(e.array().map((e=>e+t)))}get el(){return this}static get watchers(){return{value:["handleValueChange"]}}static get style(){return"@-webkit-keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in{0%{opacity:0}100%{opacity:1}}@-webkit-keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}@keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:300ms}.calcite-animate{opacity:0;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-duration:var(--calcite-animation-timing);animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{-webkit-animation-name:in;animation-name:in}.calcite-animate__in-down{-webkit-animation-name:in-down;animation-name:in-down}.calcite-animate__in-up{-webkit-animation-name:in-up;animation-name:in-up}.calcite-animate__in-scale{-webkit-animation-name:in-scale;animation-name:in-scale}:root{--calcite-popper-transition:150ms ease-in-out}:host([hidden]){display:none}:host{display:block}.container{width:100%;display:inline-grid;-ms-flex-align:center;align-items:center;grid-template-columns:1fr auto}.preview{grid-column:2/3;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;pointer-events:none;margin-top:0;margin-bottom:0;margin-left:0.25rem;margin-right:0.25rem;z-index:1}.preview,.input{grid-row:1}.input{grid-column:1/3;text-transform:uppercase;width:100%}"}};function Me(){["calcite-color-picker-hex-input","calcite-color-picker-swatch","calcite-icon","calcite-input","calcite-progress"].forEach((e=>{switch(e){case"calcite-color-picker-hex-input":customElements.get(e)||customElements.define(e,Ie);break;case"calcite-color-picker-swatch":customElements.get(e)||l();break;case"calcite-icon":customElements.get(e)||c();break;case"calcite-input":customElements.get(e)||d();break;case"calcite-progress":customElements.get(e)||h()}}))}Ie=i(Ie,[1,"calcite-color-picker-hex-input",{allowEmpty:[4,"allow-empty"],intlHex:[1,"intl-hex"],intlNoColor:[1,"intl-no-color"],scale:[513],value:[1537],internalColor:[32],setFocus:[64]},[[2,"keydown","onInputKeyDown"]]]),Me();const Re=j(ne.hex());let Le=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.calciteColorPickerChange=e(this,"calciteColorPickerChange",7),this.calciteColorPickerInput=e(this,"calciteColorPickerInput",7),this.allowEmpty=!1,this.appearance="default",this.color=ne,this.format="auto",this.hideHex=!1,this.hideChannels=!1,this.hideSaved=!1,this.intlB=se,this.intlBlue=ce,this.intlDeleteColor=he,this.intlG=de,this.intlGreen=ue,this.intlH=me,this.intlHsv=pe,this.intlHex=fe,this.intlHue=ge,this.intlNoColor=Ce,this.intlR=ve,this.intlRed=be,this.intlRgb=we,this.intlS=Se,this.intlSaturation=xe,this.intlSaveColor=ye,this.intlSaved=ke,this.intlV=Fe,this.intlValue=Ae,this.scale="m",this.value=Re,this.colorFieldAndSliderHovered=!1,this.hueThumbState="idle",this.internalColorUpdateContext=null,this.mode=T.HEX,this.shiftKeyChannelAdjustment=0,this.sliderThumbState="idle",this.colorFieldAndSliderInteractive=!1,this.channelMode="rgb",this.channels=this.toChannels(ne),this.dimensions=De.m,this.savedColors=[],this.handleTabActivate=e=>{this.channelMode=e.currentTarget.getAttribute("data-color-mode"),this.updateChannelsFromColor(this.color)},this.handleColorFieldScopeKeyDown=e=>{const t=s(e.key),i={ArrowUp:{x:0,y:-10},ArrowRight:{x:10,y:0},ArrowDown:{x:0,y:10},ArrowLeft:{x:-10,y:0}};i[t]&&(e.preventDefault(),this.scopeOrientation="ArrowDown"===t||"ArrowUp"===t?"vertical":"horizontal",this.captureColorFieldColor(this.colorFieldScopeLeft+i[t].x||0,this.colorFieldScopeTop+i[t].y||0,!1))},this.handleHueScopeKeyDown=e=>{const t=e.shiftKey?10:1,i=s(e.key),o={ArrowUp:1,ArrowRight:1,ArrowDown:-1,ArrowLeft:-1};if(o[i]){e.preventDefault();const l=o[i]*t,n=this.baseColorFieldColor.hue(),a=this.baseColorFieldColor.hue(n+l);this.internalColorSet(a,!1)}},this.handleHexInputChange=e=>{e.stopPropagation();const{allowEmpty:t,color:i}=this,l=e.target.value;if(t&&!l)return void this.internalColorSet(null);l!==(i&&j(i.hex()))&&this.internalColorSet(o(l))},this.handleSavedColorSelect=e=>{const t=e.currentTarget;this.internalColorSet(o(t.color))},this.handleChannelInput=e=>{const t=e.currentTarget,i=e.detail.nativeEvent.target,o=Number(t.getAttribute("data-channel-index")),l="rgb"===this.channelMode?ae[Object.keys(ae)[o]]:re[Object.keys(re)[o]];let n;if(this.allowEmpty&&!t.value)n="";else{const e=Number(t.value)+this.shiftKeyChannelAdjustment;n=u(e,0,l).toString()}t.value=n,i.value=n},this.handleChannelChange=e=>{const t=e.currentTarget,i=Number(t.getAttribute("data-channel-index")),o=[...this.channels];if(this.allowEmpty&&!t.value)return this.channels=[null,null,null],void this.internalColorSet(null);o[i]=Number(t.value),this.updateColorFromChannels(o)},this.handleSavedColorKeyDown=e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.handleSavedColorSelect(e))},this.handleColorFieldAndSliderMouseLeave=()=>{this.colorFieldAndSliderInteractive=!1,this.colorFieldAndSliderHovered=!1,"drag"!==this.sliderThumbState&&"drag"!==this.hueThumbState&&(this.hueThumbState="idle",this.sliderThumbState="idle",this.drawColorFieldAndSlider())},this.handleColorFieldAndSliderMouseDown=e=>{const{offsetX:t,offsetY:i}=e,o=this.getCanvasRegion(i);"color-field"===o?(this.hueThumbState="drag",this.captureColorFieldColor(t,i)):"slider"===o&&(this.sliderThumbState="drag",this.captureHueSliderColor(t)),e.preventDefault(),document.addEventListener("mousemove",this.globalMouseMoveHandler),document.addEventListener("mouseup",this.globalMouseUpHandler,{once:!0}),this.activeColorFieldAndSliderRect=this.fieldAndSliderRenderingContext.canvas.getBoundingClientRect()},this.globalMouseUpHandler=()=>{const e="drag"===this.sliderThumbState||"drag"===this.hueThumbState;this.hueThumbState="idle",this.sliderThumbState="idle",this.activeColorFieldAndSliderRect=null,this.drawColorFieldAndSlider(),e&&this.calciteColorPickerChange.emit()},this.globalMouseMoveHandler=e=>{const{el:t,dimensions:i}=this,o="drag"===this.sliderThumbState,l="drag"===this.hueThumbState;if(!t.isConnected||!o&&!l)return;let n,a;const r=this.activeColorFieldAndSliderRect,{clientX:s,clientY:c}=e;if(this.colorFieldAndSliderHovered)n=s-r.x,a=c-r.y;else{const e=i.colorField.width,t=i.colorField.height,o=i.slider.height;n=s<r.x+e&&s>r.x?s-r.x:s<r.x?0:e,a=c<r.y+t+o&&c>r.y?c-r.y:c<r.y?0:t+o}l?this.captureColorFieldColor(n,a,!1):this.captureHueSliderColor(n)},this.handleColorFieldAndSliderMouseEnterOrMove=({offsetX:e,offsetY:t})=>{const{dimensions:{colorField:i,slider:o,thumb:l}}=this;this.colorFieldAndSliderInteractive=t<=i.height+o.height,this.colorFieldAndSliderHovered=!0;const n=this.getCanvasRegion(t);if("color-field"===n){const o=this.hueThumbState,n=this.baseColorFieldColor.hsv(),a=Math.round(n.saturationv()/(re.s/i.width)),r=Math.round(i.height-n.value()/(re.v/i.height)),s=this.containsPoint(e,t,a,r,l.radius);let c=!1;"idle"===o&&s?(this.hueThumbState="hover",c=!0):"hover"!==o||s||(this.hueThumbState="idle",c=!0),"drag"!==this.hueThumbState&&c&&this.drawColorFieldAndSlider()}else if("slider"===n){const n=this.baseColorFieldColor.hsv().saturationv(100).value(100),a=this.sliderThumbState,r=Math.round(n.hue()/(360/o.width)),s=Math.round((o.height+this.getSliderCapSpacing())/2)+i.height,c=this.containsPoint(e,t,r,s,l.radius);let h=!1;"idle"===a&&c?(this.sliderThumbState="hover",h=!0):"hover"!==a||c||(this.sliderThumbState="idle",h=!0),"drag"!==this.sliderThumbState&&h&&this.drawColorFieldAndSlider()}},this.storeColorFieldScope=e=>{this.colorFieldScopeNode=e},this.renderChannelsTabTitle=e=>{const{channelMode:i,intlRgb:o,intlHsv:l}=this,n="rgb"===e?o:l;return t("calcite-tab-title",{active:e===i,class:K,"data-color-mode":e,key:e,onCalciteTabsActivate:this.handleTabActivate},n)},this.renderChannelsTab=e=>{const{channelMode:i,channels:o,intlB:l,intlBlue:n,intlG:a,intlGreen:r,intlH:s,intlHue:c,intlR:h,intlRed:d,intlS:u,intlSaturation:m,intlV:p,intlValue:f}=this,g="rgb"===e,C=g?[h,a,l]:[s,u,p],v=g?[d,r,n]:[c,m,f];return t("calcite-tab",{active:e===i,class:N,key:e},t("div",{class:G},o.map(((e,t)=>this.renderChannel(e,t,C[t],v[t])))))},this.renderChannel=(e,i,o,l)=>t("calcite-input",{class:O,"data-channel-index":i,label:l,numberButtonType:"none",onCalciteInputChange:this.handleChannelChange,onCalciteInputInput:this.handleChannelInput,prefixText:o,scale:"l"===this.scale?"m":"s",type:"number",value:null==e?void 0:e.toString()}),this.deleteColor=()=>{const e=this.color.hex();if(!(this.savedColors.indexOf(e)>-1))return;const t=this.savedColors.filter((t=>t!==e));this.savedColors=t;const i=`calcite-color-${this.storageId}`;this.storageId&&localStorage.setItem(i,JSON.stringify(t))},this.saveColor=()=>{const e=this.color.hex();if(this.savedColors.indexOf(e)>-1)return;const t=[...this.savedColors,e];this.savedColors=t;const i=`calcite-color-${this.storageId}`;this.storageId&&localStorage.setItem(i,JSON.stringify(t))},this.drawColorFieldAndSlider=function(e,t,i){var o=!0,l=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return w(i)&&(o="leading"in i?!!i.leading:o,l="trailing"in i?!!i.trailing:l),b(e,t,{leading:o,maxWait:t,trailing:l})}((()=>{this.fieldAndSliderRenderingContext&&(this.drawColorField(),this.drawHueSlider())}),16),this.captureColorFieldColor=(e,t,i=!0)=>{const{dimensions:{colorField:{height:o,width:l}}}=this,n=Math.round(re.s/l*e),a=Math.round(re.v/o*(o-t));this.internalColorSet(this.baseColorFieldColor.hsv().saturationv(n).value(a),i)},this.initColorFieldAndSlider=e=>{this.fieldAndSliderRenderingContext=e.getContext("2d"),this.setCanvasContextSize(e,{width:this.dimensions.colorField.width,height:this.dimensions.colorField.height+this.dimensions.slider.height+2*this.getSliderCapSpacing()}),this.drawColorFieldAndSlider()}}handleColorChange(e,t){this.drawColorFieldAndSlider(),this.updateChannelsFromColor(e),this.previousColor=t,this.internalColorUpdateContext||(this.value=this.toValue(e))}handleFormatChange(e){this.setMode(e),this.value=this.toValue(this.color)}handleScaleChange(e="m"){this.updateDimensions(e)}handleValueChange(e,t){const{allowEmpty:i,format:l}=this;let n=!1;if(!i||e){const i=I(e);if(!i||"auto"!==l&&i!==l)return this.showIncompatibleColorWarning(e,l),void(this.value=t);n=this.mode!==i,this.setMode(i)}const a="drag"===this.sliderThumbState||"drag"===this.hueThumbState;if(this.internalColorUpdateContext){if("initial"===this.internalColorUpdateContext)return;return this.calciteColorPickerInput.emit(),void(a||this.calciteColorPickerChange.emit())}const r=i&&!e?null:o(e),s=!R(r,this.color);(n||s)&&(this.color=r,this.calciteColorPickerInput.emit(),a||this.calciteColorPickerChange.emit())}get baseColorFieldColor(){return this.color||this.previousColor||ne}handleChannelKeyUpOrDown(e){this.shiftKeyChannelAdjustment=0;const t=s(e.key);if("ArrowUp"!==t&&"ArrowDown"!==t||!e.composedPath().some((e=>{var t;return null===(t=e.classList)||void 0===t?void 0:t.contains(O)})))return;const{shiftKey:i}=e;if(e.preventDefault(),!this.color)return this.internalColorSet(this.previousColor),void e.stopPropagation();this.shiftKeyChannelAdjustment="ArrowUp"===t&&i?9:"ArrowDown"===t&&i?-9:0}async setFocus(){return a(this.colorFieldScopeNode)}componentWillLoad(){const e=`calcite-color-${this.storageId}`;this.storageId&&localStorage.getItem(e)&&(this.savedColors=JSON.parse(localStorage.getItem(e)))}connectedCallback(){const{allowEmpty:e,color:t,format:i,value:l}=this,n=e&&!l,a=I(l),r=n||"auto"===i&&a||i===a,s=n?null:r?o(l):t;r||this.showIncompatibleColorWarning(l,i),this.setMode(i),this.internalColorSet(s,!1,"initial"),this.updateDimensions(this.scale)}disconnectedCallback(){document.removeEventListener("mousemove",this.globalMouseMoveHandler),document.removeEventListener("mouseup",this.globalMouseUpHandler)}render(){const{allowEmpty:e,color:i,intlDeleteColor:o,el:l,hideHex:a,hideChannels:s,hideSaved:c,intlHex:h,intlSaved:d,intlSaveColor:u,savedColors:m,scale:p}=this,f=i?i.hex():null,g="l"===p?"m":"s",{colorFieldAndSliderInteractive:C,colorFieldScopeTop:v,colorFieldScopeLeft:b,hueScopeLeft:w,hueScopeTop:S,scopeOrientation:x,dimensions:{colorField:{height:y,width:k},slider:{height:F}}}=this,A=null!=S?S:F/2+y,D=null!=w?w:k*ne.hue()/re.h,j=n(l),H=null===i,T="vertical"===x;return t("div",{class:L},t("div",{class:ee},t("canvas",{class:{[Q]:!0,[Z]:C},onMouseDown:this.handleColorFieldAndSliderMouseDown,onMouseEnter:this.handleColorFieldAndSliderMouseEnterOrMove,onMouseLeave:this.handleColorFieldAndSliderMouseLeave,onMouseMove:this.handleColorFieldAndSliderMouseEnterOrMove,ref:this.initColorFieldAndSlider}),t("div",{"aria-label":T?this.intlValue:this.intlSaturation,"aria-valuemax":T?re.v:re.s,"aria-valuemin":"0","aria-valuenow":(T?null==i?void 0:i.saturationv():null==i?void 0:i.value())||"0",class:{[te]:!0,[oe]:!0},onKeyDown:this.handleColorFieldScopeKeyDown,ref:this.storeColorFieldScope,role:"slider",style:{top:`${v||0}px`,left:`${b||0}px`},tabindex:"0"}),t("div",{"aria-label":this.intlHue,"aria-valuemax":re.h,"aria-valuemin":"0","aria-valuenow":(null==i?void 0:i.round().hue())||ne.round().hue(),class:{[te]:!0,[ie]:!0},onKeyDown:this.handleHueScopeKeyDown,role:"slider",style:{top:`${A}px`,left:`${D}px`},tabindex:"0"})),a&&s?null:t("div",{class:{[_]:!0,[P]:!0,[r.rtl]:"rtl"===j}},a?null:t("div",{class:$},t("span",{class:{[B]:!0,[Y]:!0}},h),t("calcite-color-picker-hex-input",{allowEmpty:e,class:N,dir:j,onCalciteColorPickerHexInputChange:this.handleHexInputChange,scale:g,value:f})),s?null:t("calcite-tabs",{class:{[V]:!0,[U]:!0},dir:j,scale:g},t("calcite-tab-nav",{slot:"tab-nav"},this.renderChannelsTabTitle("rgb"),this.renderChannelsTabTitle("hsv")),this.renderChannelsTab("rgb"),this.renderChannelsTab("hsv"))),c?null:t("div",{class:{[z]:!0,[P]:!0}},t("div",{class:B},t("label",null,d),t("div",{class:J},t("calcite-button",{appearance:"transparent",class:q,color:"neutral",disabled:H,iconStart:"minus",label:o,onClick:this.deleteColor,scale:g}),t("calcite-button",{appearance:"transparent",class:X,color:"neutral",disabled:H,iconStart:"plus",label:u,onClick:this.saveColor,scale:g}))),m.length>0?t("div",{class:W},[...m.map((e=>t("calcite-color-picker-swatch",{active:f===e,class:le,color:e,key:e,onClick:this.handleSavedColorSelect,onKeyDown:this.handleSavedColorKeyDown,scale:p,tabIndex:0})))]):null))}showIncompatibleColorWarning(e,t){console.warn(`ignoring color value (${e}) as it is not compatible with the current format (${t})`)}setMode(e){this.mode="auto"===e?this.mode:e}captureHueSliderColor(e){const{dimensions:{slider:{width:t}}}=this,i=360/t*e;this.internalColorSet(this.baseColorFieldColor.hue(i),!1)}getCanvasRegion(e){const{dimensions:{colorField:{height:t},slider:{height:i}}}=this;return e<=t?"color-field":e<=t+i?"slider":"none"}internalColorSet(e,t=!0,i="internal"){t&&R(e,this.color)||(this.internalColorUpdateContext=i,this.color=e,this.value=this.toValue(e),this.internalColorUpdateContext=null)}toValue(e,t=this.mode){if(!e)return null;if(t.includes("hex"))return j(e.round().hex());if(t.includes("-css"))return e[t.replace("-css","").replace("a","")]().round().string();const i=e[t]().round().object();return t.endsWith("a")&&(i.a=i.alpha,delete i.alpha),i}getSliderCapSpacing(){const{dimensions:{slider:{height:e},thumb:{radius:t}}}=this;return 2*t-e}updateDimensions(e="m"){this.dimensions=De[e]}drawColorField(){const e=this.fieldAndSliderRenderingContext,{dimensions:{colorField:{height:t,width:i}}}=this;e.fillStyle=this.baseColorFieldColor.hsv().saturationv(100).value(100).string(),e.fillRect(0,0,i,t);const o=e.createLinearGradient(0,0,i,0);o.addColorStop(0,"rgba(255,255,255,1)"),o.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=o,e.fillRect(0,0,i,t);const l=e.createLinearGradient(0,0,0,t);l.addColorStop(0,"rgba(0,0,0,0)"),l.addColorStop(1,"rgba(0,0,0,1)"),e.fillStyle=l,e.fillRect(0,0,i,t),this.drawActiveColorFieldColor()}setCanvasContextSize(e,{height:t,width:i}){const o=window.devicePixelRatio||1;e.width=i*o,e.height=t*o,e.style.height=`${t}px`,e.style.width=`${i}px`;e.getContext("2d").scale(o,o)}containsPoint(e,t,i,o,l){return Math.pow(e-i,2)+Math.pow(t-o,2)<=Math.pow(l,2)}drawActiveColorFieldColor(){const{color:e}=this;if(!e)return;const t=e.hsv(),{dimensions:{colorField:{height:i,width:o},thumb:{radius:l}}}=this,n=t.saturationv()/(re.s/o),a=i-t.value()/(re.v/i);requestAnimationFrame((()=>{this.colorFieldScopeLeft=n,this.colorFieldScopeTop=a})),this.drawThumb(this.fieldAndSliderRenderingContext,l,n,a,t,this.hueThumbState)}drawThumb(e,t,i,o,l,n){const a=2*Math.PI;e.beginPath(),e.arc(i,o,t,0,a),e.shadowBlur="hover"===n?32:16,e.shadowColor=`rgba(0, 0, 0, ${"drag"===n?.32:.16})`,e.fillStyle="#fff",e.fill(),e.beginPath(),e.arc(i,o,t-3,0,a),e.shadowBlur=0,e.shadowColor="transparent",e.fillStyle=l.rgb().string(),e.fill()}drawActiveHueSliderColor(){const{color:e}=this;if(!e)return;const t=e.hsv().saturationv(100).value(100),{dimensions:{colorField:{height:i},slider:{height:o,width:l},thumb:{radius:n}}}=this,a=t.hue()/(360/l),r=o/2+i;requestAnimationFrame((()=>{this.hueScopeLeft=a,this.hueScopeTop=r})),this.drawThumb(this.fieldAndSliderRenderingContext,n,a,r,t,this.sliderThumbState)}drawHueSlider(){const e=this.fieldAndSliderRenderingContext,{dimensions:{colorField:{height:t},slider:{height:i,width:l}}}=this,n=e.createLinearGradient(0,0,l,0),a=["red","yellow","lime","cyan","blue","magenta","red"],r=1/(a.length-1);let s=0;a.forEach((e=>{n.addColorStop(s,o(e).string()),s+=r})),e.fillStyle=n,e.clearRect(0,t,l,i+2*this.getSliderCapSpacing()),e.fillRect(0,t,l,i),this.drawActiveHueSliderColor()}updateColorFromChannels(e){this.internalColorSet(o(e,this.channelMode))}updateChannelsFromColor(e){this.channels=e?this.toChannels(e):[null,null,null]}toChannels(e){const{channelMode:t}=this;return e[t]().array().map((e=>Math.floor(e)))}get el(){return this}static get watchers(){return{color:["handleColorChange"],format:["handleFormatChange"],scale:["handleScaleChange"],value:["handleValueChange"]}}static get style(){return"@-webkit-keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in{0%{opacity:0}100%{opacity:1}}@-webkit-keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}@keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:300ms}.calcite-animate{opacity:0;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-duration:var(--calcite-animation-timing);animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{-webkit-animation-name:in;animation-name:in}.calcite-animate__in-down{-webkit-animation-name:in-down;animation-name:in-down}.calcite-animate__in-up{-webkit-animation-name:in-up;animation-name:in-up}.calcite-animate__in-scale{-webkit-animation-name:in-scale;animation-name:in-scale}:root{--calcite-popper-transition:150ms ease-in-out}:host([hidden]){display:none}:host{display:inline-block;font-size:var(--calcite-font-size--2);line-height:1rem;font-weight:var(--calcite-font-weight-normal)}:host([scale=s]) .container{width:160px}:host([scale=s]) .saved-colors{grid-template-columns:repeat(auto-fill, minmax(20px, 1fr))}:host([scale=s]) .channels{-ms-flex-direction:column;flex-direction:column}:host([scale=s]) .channel{width:100%;margin-bottom:4px}:host([scale=s]) .channel:last-child{margin-bottom:0}:host([scale=m]) .container{width:272px}:host([scale=l]) .control-section.section.calcite--rtl>:nth-child(2){margin-left:0;margin-right:12px}:host([scale=l]) .header{padding-bottom:0}:host([scale=l]){font-size:var(--calcite-font-size--1);line-height:1rem}:host([scale=l]) .container{width:464px}:host([scale=l]) .color-field-and-slider{margin-bottom:-20px}:host([scale=l]) .section{padding:0 16px 16px}:host([scale=l]) .section:first-of-type{padding-top:16px}:host([scale=l]) .saved-colors{grid-template-columns:repeat(auto-fill, minmax(28px, 1fr));grid-gap:12px;padding-top:16px}:host([scale=l]) .control-section{-ms-flex-wrap:nowrap;flex-wrap:nowrap;-ms-flex-align:baseline;align-items:baseline}:host([scale=l]) .control-section>:nth-child(2){margin-left:12px}:host([scale=l]) .color-hex-options{-ms-flex-negative:1;flex-shrink:1;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:distribute;justify-content:space-around;min-height:98px;width:160px}:host([scale=l]) .color-mode-container{-ms-flex-negative:3;flex-shrink:3}:host([appearance=minimal]) .container{border:none}.container{background-color:var(--calcite-ui-foreground-1);display:inline-block;border:1px solid var(--calcite-ui-border-1)}.color-field-and-slider-wrap{position:relative}.scope{font-size:var(--calcite-font-size--1);padding:0;margin-bottom:0;margin-right:0;outline-offset:0;outline-color:transparent;-webkit-transition:outline-offset 100ms ease-in-out, outline-color 100ms ease-in-out;transition:outline-offset 100ms ease-in-out, outline-color 100ms ease-in-out;width:0.5rem;height:0.5rem;position:absolute;pointer-events:none;margin-top:-0.25rem;margin-left:-0.25rem;outline-offset:10px}.scope:focus{outline:2px solid var(--calcite-ui-brand);outline-offset:2px;outline-offset:12px}.color-field-and-slider{margin-bottom:-16px}.color-field-and-slider--interactive{cursor:pointer}.control-section{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap}.section{padding:0 12px 12px}.section:first-of-type{padding-top:12px}.color-hex-options,.section--split{-ms-flex-positive:1;flex-grow:1}.header{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;color:var(--calcite-ui-text-1);padding-bottom:0.25rem}.header--hex,.color-mode-container{padding-top:12px}.channels{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between}.channel{width:31%}.saved-colors{padding-top:12px;display:grid;grid-template-columns:repeat(auto-fill, minmax(24px, 1fr));grid-gap:8px;width:100%}.saved-colors-buttons{display:-ms-flexbox;display:flex}.saved-color{outline-offset:0;outline-color:transparent;-webkit-transition:outline-offset 100ms ease-in-out, outline-color 100ms ease-in-out;transition:outline-offset 100ms ease-in-out, outline-color 100ms ease-in-out;cursor:pointer}.saved-color:focus{outline:2px solid var(--calcite-ui-brand);outline-offset:2px}.saved-color:hover{-webkit-transition:outline-color 100ms ease-in-out;transition:outline-color 100ms ease-in-out;outline:2px solid var(--calcite-ui-border-2);outline-offset:2px}"}};function _e(){["calcite-color-picker","calcite-button","calcite-color-picker-hex-input","calcite-color-picker-swatch","calcite-icon","calcite-input","calcite-loader","calcite-progress","calcite-tab","calcite-tab-nav","calcite-tab-title","calcite-tabs"].forEach((e=>{switch(e){case"calcite-color-picker":customElements.get(e)||customElements.define(e,Le);break;case"calcite-button":customElements.get(e)||m();break;case"calcite-color-picker-hex-input":customElements.get(e)||Me();break;case"calcite-color-picker-swatch":customElements.get(e)||l();break;case"calcite-icon":customElements.get(e)||c();break;case"calcite-input":customElements.get(e)||d();break;case"calcite-loader":customElements.get(e)||p();break;case"calcite-progress":customElements.get(e)||h();break;case"calcite-tab":customElements.get(e)||f();break;case"calcite-tab-nav":customElements.get(e)||g();break;case"calcite-tab-title":customElements.get(e)||C();break;case"calcite-tabs":customElements.get(e)||v()}}))}Le=i(Le,[1,"calcite-color-picker",{allowEmpty:[4,"allow-empty"],appearance:[513],color:[1040],format:[1],hideHex:[4,"hide-hex"],hideChannels:[4,"hide-channels"],hideSaved:[4,"hide-saved"],intlB:[1,"intl-b"],intlBlue:[1,"intl-blue"],intlDeleteColor:[1,"intl-delete-color"],intlG:[1,"intl-g"],intlGreen:[1,"intl-green"],intlH:[1,"intl-h"],intlHsv:[1,"intl-hsv"],intlHex:[1,"intl-hex"],intlHue:[1,"intl-hue"],intlNoColor:[1,"intl-no-color"],intlR:[1,"intl-r"],intlRed:[1,"intl-red"],intlRgb:[1,"intl-rgb"],intlS:[1,"intl-s"],intlSaturation:[1,"intl-saturation"],intlSaveColor:[1,"intl-save-color"],intlSaved:[1,"intl-saved"],intlV:[1,"intl-v"],intlValue:[1,"intl-value"],scale:[513],storageId:[1,"storage-id"],value:[1025],colorFieldAndSliderInteractive:[32],channelMode:[32],channels:[32],dimensions:[32],savedColors:[32],colorFieldScopeTop:[32],colorFieldScopeLeft:[32],scopeOrientation:[32],hueScopeLeft:[32],hueScopeTop:[32],setFocus:[64]},[[2,"keydown","handleChannelKeyUpOrDown"],[2,"keyup","handleChannelKeyUpOrDown"]]]),_e();const $e=Le,Pe=_e;export{$e as CalciteColorPicker,Pe as defineCustomElement};
